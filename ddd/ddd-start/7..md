# 7. 도메인 서비스

## 01. 여러 애그리거트가 필요한 기능 

### 1 . 애그리거트로 기능을 구현할 수 없을 때 

* 하나의 애그리거트로는 기능을 구현할 수 없을 때가 있다.
  * ex\) 결제 금액 계산 로직 
    * 상품 애그리거트 
      * 구매하는 상품의 가격이 필요
      * 상품에 따라 배송비가 추가되기도 함 
    * 주문 애그리거트
      * 상품별로 구매 개수가 필요 
    * 할인 쿠폰 애그리거트
      * 쿠폰별로 지정한 할인 금액이나 비율에 따라  주문 총 금액을 할인 
      * 할인 쿠폰을 조건에 따라 중복 사용할 수 있다거나  지정한 카테고리의 상품에만 적용할 수 있는 경우  할인 계산이 복잡해짐 
    * 회원 애그리거트 
      * 회원 등급에 따라 추가 할인이 가 
  * 이 경우 실제 결제 금액은 누구의 책임인지  판별하기 힘들어짐 
  * 하나의 애그리거트에 몰아넣게 되면, 해당 애그리거트와 관련 없는 코드가 추가되는 문제 발생



* 따라서 하나의 애그리거트에 넣기에 애매한 도메인 기능을  특정 애그리거트에서 억지로 구현하면 안된다. 
  * 애그리거트 자신의 책임을 넘어서는 기능을 구현하기  때문에,  코드가 길어지고, 외부에 대한 의존이 높아지게 된다 .
  * 이는 코드를 복잡하게 만들어 수정을 어렵게 만든다.
  * 또한 애그리거트의 범위를 넘어서는 도메인 개념이  애그리거트에 숨어들어서 명시적으로 드러나지 않게 된다.  
* 해결 방법
  * 도메인 서비스를 별도로 구현하는 것 

## 02. 도메인 서비스

### 0. 도메인 서비스 

* 하나의 애그리거트에 넣기 애매한 도메인 개념을 구현하기 위해  도메인 서비스를 이용해서, 도메인 개념을  명시적으로 드러내면 된다.  
* 응용 서비스가 응용 로직을 다룬다면, 도메인 서비스는 도메인 로직을 다룬다.  
* 도메인 서비스와  도메인 영역의 애그리거트나 밸류 등 다른 구성요소와의 차이 
  * 상태 없이 로직만 구현 
  * 도메인 서비스를 구현하는데 필요한 상태는  애그리거트나 다른 방법으로 전달받는다.  
* 예시: 할인 금액 계싼 로직을 위한 도메인 서비스 
  * 도메인의 의미가 드러나는 용어를 타입과 메소드 이름으로 갖는다. 

![](../../.gitbook/assets/image%20%2822%29.png)



### 1 . 도메인 서비스의 패키지 위치

### 2. 도메인 서비스의 인터페이스와 클래스 

