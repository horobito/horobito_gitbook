# 1.오브젝트와 의존관계

## 00. 배울 내용 

### 01. 1장의 흐름

* 구현하는 것
  * 사용자 정보를 DB에 등록 또는 ID로 조회하는 기능을 가진  DAO 코드 제작,
  * 이 코드의 문제점을 파악
  * 문제들을 다양한 방법과 패턴, 원칙, IoC/DI 프레임워크를 적용하며 해결  

### 02. 스프링 관련 용어들 

* **스프링**

  * 어떻게 오브젝트가 설계되고, 만들어지고,  어떻게 관계를 맺고 사용되는지에 관심을 갖는 프레임워크  
  * 스프링의 관심

    * 오브젝트와 그 관계  

* **스프링 IoC의 용어**

  * **1 . 빈\[Bean\] 또는 빈 오브젝트** 
    * 스프링이 IoC 방식으로 관리하는 오브젝트라는 의미

      * 따라서 관리되는 오브젝트\[Managed Object\]라고 부르기도 한다 

    * 주의점 
      * 스프링을 사용하는 애플리케션에서 만들 어지는 모든 오브젝트가 다 빈은 아니다 .
      * 그 중에서 스프링이 직접 그 생성과 제어를 담당하느 오브젝트만  \[빈\] 이라고 부른다.  
  * **2. 빈 팩토리\[Bean Factory\]**
    * 스프링의 IoC를 담당하는 핵심 컨테이너  
    * 기능
      * 빈을 등록 
      * 빈을 생성
      * 빈을 조회
      * 그 외 부가적인 빈을 관리하는 기능 담당  
    * 보통 빈 팩토리를 바로 사용하지 않고, 이를 확장한 애플리케이션 컨텍스트를 이용  
    * BeanFactory 라고 붙여쓰면, 빈 팩토리가 구현하고 있는  가장 기본적인 인터페이스의 이름이 된다.  
  * **3. 애플리케이션 컨텍스트\[Application Context\]**
    * 빈 팩토리를 확장한 IoC 컨테이너  
    * 빈을 등록하고, 관리하는 기본적인 기능은 빈 팩토리와 동일 
      * 여기에  스프링이 제공하는 각종 부가 서비스를 추가로 제공한 것 
    * 빈 팩토리라고 부를 때는
      *  주로 빈의 생성과 제어의 관점에서 이야기한 것 
    * 애플리케이션 컨텍스트라고 할 때는 
      * 스프링이 제공하는 애플리케이션 지원 기능을  모두 포함해서 이야기하는 것 
    * ApplicationContext 라고 적으면  애플리케이션 컨텍스트가 구현해야 하는  기본 인터페이스를 가리키는 것  
    * ApplicationContext 는 BeanFactory를 상속한다.  
  * **4. 설정정보/설정 메타정보\[Configuration Metadata\]**
    * 애플리케이션 컨텍스트 또는 빈 팩토리가  IoC를 적용하기 위해 사용하느 메타 정보  
    * Configuration 의 의미
      * 구성정보 내지는 형상정보를 의미
      * IoC 컨테이너에 의해 관리되는 애플리케이션 오브젝트를  생성하고 구성할 때 사용되기 때문  
    * 애플리케이션의 형상정보라고 부르기도 한다 .
      * 또는 애플리케이션의 전체 그림이 그려진  청사진이라고도 한다.  
  * **5. 컨테이너 또는 IoC 컨테이너** 

    * IoC 방식으로 빈을 관리한다는 의미에서, 애플리케이션 컨텍스트나 빈 팩토리를  컨테이너 또는 IoC 컨테이너라고도 한다. 
      * IoC 컨테이너라고 부를 때
        * 빈 팩토리의 관점에서 이야기 하는 것 
      * 컨테이너 또는 스프링 컨테이너라고 부를 때 
        * 애플리케이션 컨텍스트를 가리키는 것  
    * \[컨테이너\]라는 말 자체가 IoC 의 개념을 담고 있기 때문에  
      애플리케이션 컨텍스트 대신  
       스프링 컨테이너라고 부르는 걸 선호하기도 함 

      * 또한 \[컨테이너\]라는 말은 애플리케이션 컨텍스트보다 추상적인 표현  

    * 또는 \[애플릴케이션 컨텍스트\]는 그 자체로 ApplicationContext 인터페이스를  구현한 오브젝트를 가리키도 하는데, 애플리케이션 컨텍스트 오브젝트는 하나의 애플리케이션에서 보통  여러개가 만들어져 사용됨 
      * 이를 통틀어서 스프링 컨테이라고도 부를 수 잇다.  
    * 때로는 컨테이너라는 말을 때고, \[스프링\]이라고도 부를 때도, 이 스프링 컨테이너를 가리크는 것일 수 있다.
      * ex\)
        * \[스프링에 빈을 등록하고 \] 라는 식으로 말하는 경우, \[스프링\]이라는 말은 스프링 컨테이너 또는 애플리케이션 컨텍스트를  가리키는 말 

  


  * **6. 스프링 프레임워크** 
    * IoC 컨테이너, 애플리케이션 컨텍스트를 포함해서 , 스프링이 제공하는 모든 기능을 통틀어 말할 때 주로 사용  
    * 그냥 \[스프링\]으로 줄여서 말하기도 한다. 



### 03. 배우는 것들 



* 책임이 다른 코드를 분리해서 두 개의 클래스로 분리
  * **관심사의 분리, 리팩토링** 
* 바뀔 수 있는 쪽의 클래스는 인터페이스를 구현, 다른 클래스에서는 인터페이스를 통해서만 접근하도록 만듬
  * 이를 통해 인터페이스를 정의한 쪽의 구현 방법이 달라져 , 클래스가 바뀌더라도, 그 기능을 사용하는 클래스의 코드는 같이 수정할 필요가 없도록 한다
    * **전략 패턴**  
* 이를 통해 자신의 책임 자체가 변경되는 경우 외에는 , 불필요한 변화가 발생하지 않도록 막아주고, 자신이 사용하는 외부 오브젝트의 기능은 자유롭게 확장하거나  변경할 수 있게 만듬
  * **개방 폐쇄 원칙**



* 결국 한쪽의 기능 변화가 다른 쪽의 변경을 요구하지 않아도 되게 했고\[낮은 결합도\], 자신의 책임과 관심사에만 순수하게 집중하는\[높은 응집도\] 깔끔한 코드 제작이 가능해짐  
* 오브젝트가 생성되고, 여타 오브젝트와 관계를 맺는 작업의 제어권을 별도의 오브젝트 팩토리를 만들어 넘김 또는 오브젝트 팩토리의 기능을 일반화한 IoC 컨테이너로 넘겨서, 오브젝트가 자신이 사용할 대상의 생성이나 선택에 관한 책임으로부터  자유롭게 만들어줌 
  * **제어의 역전\[IoC\]** 
* 전형적인 싱글톤 패턴 구현 방식의 단점을 살펴보고, 서버에서 사용되는 서비스 오브젝트로서의 장점을 살릴 수 있는 싱글톤을 사용하면서도 싱글톤 패턴의 단점을 극복할 수 있도록 설계된 컨테이너를 활용하는 방법에 대해 알아봄
  * **싱글톤 레지스트리**   
* 설계 시점과 코드에는 클래스와 인터페이스 사이의 느슨한 의존관계만 만들어놓고, 런타임 시에 실제 사용할 구체적인 의존 오브젝트를 제 3자\[DI 컨테이너 \]의 도움으로  주입받아서, 다이나믹한 의존관계를 갖게 해주는 IoC의 특별한 케이스를 알아봄 
  * **의존관계 주입\[DI\]** 
* 의존 오브젝트를 주입할 때  생성자를 이용하는 방법과 수정자 메소드를 이용하는 방법을 알아봄
  * **생성자 주입과 수정자 주입** 

## 01. 초난감 DAO

### 1 . User

### 2. UserDAO

### 3. main\(\)을 이용한 DAO 테스트 코



## 02. DAO의 분리

### 1 . 관심사의 분리

### 2 . 커넥션 만들기와 추출 

#### 2.1 UserDao 의 관심사항

#### 2.2 중복 코드의 메소드 추출

#### 2.3 변경사항에 대한 검증 : 리팩토링과 테스

### 3. DB 커넥션 만들기의 독립 

#### 3.1 상속을 통한 확

## 03. DAO의 확장

### 1 . 클래스의 분리

### 2 . 인터페이스의 도입

### 3. 관계설정 책임의 분리

### 4. 원칙과 패턴

#### 4.1 개방 패쇄 원칙

#### 4.2 높은 응집도와 낮은 결합도 

#### 4.3 전략 패턴 

## 04. 제어의 역전\(IOC\)

### 1 . 오브젝트 팩토리

#### 1.1 팩토리

#### 1.2 설계도로서의 팩토리 

### 2. 오브젝트 팩토리의 활용

### 3. 제어권의 이전을 통한 제어관계 역전 



## 05. 스프링의 IOC

### 1 . 오브젝트 팩토리를 이용한 IOC 

1.1 애플리케이션 컨텍스트와 설정 정보

1.2 DaoFactory를 사용하는 애플리케이션 컨텍스트

### 2 . 애플리케이션 컨텍스트의 동작 방식

### 3. 스프링 IoC의 용어 정



## 06. 싱글톤 레지스트리와 오브젝트 스코프

### 1 . 싱글톤 레지스트리로서의 애플리케이션 컨텍스트

1.1 서버 애플리케이션과 싱글톤

1.2 싱글톤 패턴의 한계

1.3 싱글톤 레지스트리

### 2. 싱글톤과 오브젝트의 상태

### 3. 스프링 빈의 스코프 

## 07. 의존관계 주입\[DI\]

### 1 . 제어의 역전\[IoC\]과 의존관계 주입

### 2. 런타임 의존관계 설정

2.1 의존관계

2.2. UserDao의 의존관계

2.3 UserDao의 의존관계 주입

### 3. 의존관계 검색과 주입

### 4. 의존관계 주입의 응용

### 5. 메소드를 이용한 의존관계 주입 

